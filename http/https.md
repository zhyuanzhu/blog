# https

> 在 `HTTP应用层` 和 `TCP传输层` 提供了一个传输级别的安全层，可以使用 `SSL` 也可以使用 `TLS`（在请求和响应数据发送到网络之前加密处理）

- 安全的http需要满足的条件：

  - 服务器认证（客户端知道它们是在与真正的而不是伪造的服务器通话）

  - 客户端认证（服务器知道它们是在和真正的而不是伪造的客户端通话）

  - 完整性（客户端与服务器的数据不会被修改）

  - 加密（客户端与服务器的数据传输是私密的，不会被窃听）

  - 效率（运行足够快，以便低端服务器和客户端使用）

  - 普适性（基本上所有的服务器和客户端都支持）

  - 管理的可扩展性（在任何地方的任何人都可以立即进行安全通信）

  - 适应性（能够支持当前最知名的安全方法）

  - 在社会上的可行性（满足社会各种使用场景）

## 公开密钥加密技术

- 使用 两个`非对称密钥`；（一个用来编码报文，一个用来解码报文）

- 所有客户端都可以使用 `公开密钥` 对数据进行加密

- 只有服务器上的 `私有密钥` 可以将加密后的数据进行解密

## 数字签名

> 除了加/解密报文之外，还可以用加密系统对报文进行 `签名（sign）`，以说明是谁编写的报文，同时证明报文未被篡改过

- 签名是加了密的校验和

  - 签名可以证明是作者编写了这条报文。只有作者才有 `私有密钥`

  - 签名可以防止报文被篡改。修改了传输报文之后，校验和不再匹配

- 数字签名通常使用 `非对称公开密钥技术` 产生

## 数字证书

> `数字证书` 通常被称作 `certs`。包含了由某个受信任组织担保的用户或公司的相关信息；由一个官方的 `证书颁发机构` 以数字方式签发

- 数字证书的主要内容

  - 对象名称

  - 过期时间

  - 证书颁发者

  - 来自证书颁发者的数字签名

  - 通常包括公开密钥以及对象和所用签名算法的描述信息

- 现在大多数的数字证书使用 `X.509 v3`

- 使用 `HTTPS` 建立一个安全的 Web事务之后，浏览器会自动获取服务器的数字证书。如果没有，连接会失败

- 获取数字证书之后，如果是知名的机构颁发，浏览器可能已经预先安装了；如果对签名颁发机构不清楚，就无法确定是否应该信任这个签名颁发机构；通常会向用户现实一个对话框，由用户决定是否相信这个签名发布者

## HTTPS

- 建立安全传输

  客户端首先打开一条到服务器端口 `443`（HTTPS的默认端口）的连接。一旦建立了 TCP 连接，客户端和服务器就会初始化 `SSL层`，对加密参数进行沟通，并交换密钥。

  握手完成之后，`SSL` 初始化就完成了，客户端就可以将请求报文发送给安全层了。在将这些请求报文发送给 TCP 之前，先对其进行加密

- SSL 握手

  - 交换协议版本号

  - 选择一个两端都了解都密码

  - 对两端的身份进行认证

  - 生成临时的会话密钥，以便紧密信道

- 站点证书的有效性

  - 检测日期

  - 签名版发着可信度检测

  - 签名检测：判定签名可信之后，浏览器使用签名机构的公开密钥与证书校验码进行比较，查看证书是否完整

  - 站点身份检测：浏览器去验证证书中的域名与它们所对话的服务器的域名是否匹配